---
title: "605-HW13-Calculus"
author: "Michael Y."
date: "November 24, 2019"
output:
  html_document:
    highlight: pygments
    theme: cerulean
    code_folding: show
    toc: yes
    toc_float: yes
    toc_depth: 3
    md_extensions: +grid_tables
  pdf_document:
    md_extensions: +grid_tables
    toc: yes
    toc_depth: 3
classoption: portrait
editor_options:
  chunk_output_type: inline
header-includes: 
- \usepackage{graphicx}
- \usepackage{float}
---

<style>
  .main-container {
    max-width: 1200px !important;
  }
</style>

---


```{r setup, eval=T, echo=F}
# Setup
knitr::opts_chunk$set(echo = TRUE,
                      fig.pos='H')
directory = "C:/Users/Michael/Dropbox/priv/CUNY/MSDS/201909-Fall/DATA605_Larry/20191124_Week13/"
knitr::opts_knit$set(root.dir = directory)

### Make the output wide enough
options(scipen = 999, digits=9, width=150)
```

```{r load, eval=T, message=F,warning=F, echo=F}
### load some libraries
library(datasets)
library(kableExtra)
```

\newpage
# HW13 - Calculus

### 1. Use integration by substitution to solve the integral $\int{4e^{-7x} dx}$  .

F(x) = $\int{4e^{-7x} dx}$    .

Let $u = -7x$ .    
Then $du = -7dx$ , so $dx = \frac{du}{-7}$    .     

So, 
$$\begin{aligned}
\int{4e^{-7x} dx} 
&= \int{\frac{-4}{7}e^{u} du} \\
&= \frac{-4}{7}e^{u}+C        \\
&= \frac{-4}{7}e^{-7x} + C
\end{aligned}$$

***
\newpage

### 2. Biologists are treating a pond contaminated with bacteria. 
The level of contamination is changing at a rate of 
$\frac{dN}{dt} = - \frac{3150}{t^4} -220$
bacteria per cubic centimeter per day, where $t$ is the number of days since treatment began.     

Find a function $N( t )$ to estimate the level of contamination if the level after 1 day was 6530 bacteria per cubic centimeter.

$$\begin{aligned} N(t)-N(0)
&=\int\limits_0^t {\left(\frac{-3150}{s^{4}}-220 \right)ds}\\
&=\int\limits_0^t {\left(-3150{s^{-4}}-220 \right)ds}\\
&=\int\limits_0^t-3150\cdot s^{-4}ds - \int\limits_0^s 220ds\\
&=-3150\int\limits_0^t s^{-4}ds - 220\int\limits_0^t ds\\
&=\left[ -3150 \frac{-1}{3} s^{-3} - 220s \right]_{s=0}^{s=t}\\
&=\frac{3150}{3} t^{-3} - 220t -0+0\\
N(t)-N(0)&=\frac{1050}{ t^{3}} - 220t \\
\end{aligned}$$     

We are given an initial condition: $N(t=1)=6530$ .

So, $$\begin{aligned}
N(1)-N(0)&=\frac{1050}{ 1^{3}} - 220 \cdot 1 = 1050 - 220 = 830 \\
6530-N(0)&=830\\
N(0) &= 6530 - 830 = 5700
\end{aligned}$$

Therefore, the solution is $N(t)=  \frac{1050}{t^{3}}-220t+5700$ .

Note that the solution is not defined at $t=0$ .    
Note also that the first term will become asymptotically zero, so the reduction in bacteria will soon become linear at -220 per cubic centimeter per day.  At day 26, the amount of bacteria would become negative, which is of course not feasible ...


***
\newpage

### 3. Find the total area of the red rectangles in the figure below, where the equation of the line is $f ( x ) = 2x-9$ .
```{r rectanges-image, echo=FALSE, out.width = '30%'}
knitr::include_graphics("3-Rectangles.JPG")
```

By inspection, we can see that the area is 1+3+5+7 = 16 .   

Using calculus, we compute as follows:

$$\begin{aligned}
\int\limits_{4.5}^{8.5}{(2x-9)dx}
&=[x^2-9x]_{x=\frac{9}{2}}^{x=\frac{17}{2}} \\
&=\left(\frac{17}{2}\right)^2-\frac{9\cdot17}{2} 
- \left(\frac{9}{2}\right)^2+\frac{9\cdot9}{2} \\
&= \frac{289-81}{4} - \frac{153-81}{2} \\
&= \frac{208}{4} - \frac{72}{2} \\
&= 52 - 36   \\
&= 16
\end{aligned}$$


***
\newpage

### 4. Find the area of the region bounded by the graphs of the given equations: $y = x^2 -2x - 2$, $y = x + 2$

First, let's determine where these curves intersect:    
$$\begin{aligned}
x^2 -2x - 2 &= x + 2 \\
x^2 -3x - 4 &= 0 \\
(x+1)(x-4) &= 0 \\
x &\in\{-1,4\}
\end{aligned}$$

```{r plots}
y1 <- function(x) x^2 - 2*x -2
y2 <- function(x) x + 2
curve(expr = y1(x), from = -1, to = 4, col="red")
curve(expr = y2(x), from = -1, to = 4, col="blue", add=TRUE)
title(main = "Computing the area between two curves")
```

So, we clearly want to compute the following quantity:    

$$\begin{aligned}
\int\limits_{-1}^4 {(x + 2) - ( x^2 - 2x -2)} 
&= \int\limits_{-1}^4 { (-x^2 + 3x +4)}dx \\
&= \left. -\frac{x^3}{3}+\frac{3x^2}{2}+4x \right]_{-1}^4 \\
&= -\frac{4^3}{3}+\frac{3\cdot 4^2}{2}+4 \cdot 4 - \left( -\frac{(-1)^3}{3}+\frac{3\cdot(-1)^2}{2}+4\cdot(-1)  \right) \\
&= -\frac{64}{3}+\frac{48}{2}+16 - \left( \frac{1}{3}+\frac{3}{2}-4  \right)  \\
&= -\frac{65}{3}+\frac{45}{2}+20 \\
&= -\frac{130}{6}+\frac{135}{6}+20 \\
&= 20+\frac{5}{6} \\
&= 20.8333333
\end{aligned}$$


We can double check using the "integrate" function:

```{r integrate, echo=T}
integrate(y2, lower = -1, upper = 4)$value - integrate(y1, lower = -1, upper = 4)$value
```

***
\newpage

### 5. A beauty supply store expects to sell 110 flat irons during the next year. 
It costs \$3.75 to store one flat iron for one year.    
There is a fixed cost of \$8.25 for each order.      
Find the lot size and the number of orders per year that will minimize inventory costs.    

We will make the following assumptions:

* We will order 110 flat irons over the next year, and assume we will sell each one at a constant rate, i.e., one iron sold every $\frac{365}{110} \approx 3.32$ days.
* We are not concerned with the purchase or sales price for the irons, as no information is provided.
* During the year, we will place $numOrders$ orders, where each order will be placed for $lotSize = \frac{110}{numOrders}$ irons .
* This means that the fixed cost associated with placing the orders will be  $8.25 * numOrders$  dollars .
* On average, the number of irons in storage will be $\frac{lotsize}{2}$ .
* The cost associated with maintaining such storage (over the year) will be $3.75 * \frac{lotSize}{2}$ dollars.

Thus, the cost function that we seek to minimize is:

$$
\begin{aligned}
inventoryCost 
&= 8.25 * numOrders + 3.75 * \frac{lotSize}{2} \\
&= 8.25 * numOrders + 3.75 * \frac{110}{2\cdot numOrders} \\
&= 8.25 * numOrders +  \frac{3.75 * 55}{numOrders} \\
inventoryCost &= 8.25 * numOrders +  \frac{206.25}{numOrders}
\end{aligned}$$

To find the extremum,
$\frac{d(inventoryCost)}{d(numOrders)} = 8.25 -  \frac{206.25}{numOrders^2} = 0$     
So, $8.25 =  \frac{206.25}{numOrders^2}$ , or $(numOrders)^2 =  \frac{206.25}{8.25}=25$ .    

Therefore, $numOrders = 5$ and $lotSize = \frac{110}{numOrders} = \frac{110}{5} = 22$ .

Therefore, we should place 5 orders each year, with 22 flatirons in each order.

The cost associated with submitting the orders will be $8.25 * 5 = 41.25$ dollars,     
and the cost associated with holding an average of $\frac{22}{2}=11$ irons in inventory will also be $3.75 *11 = 41.25$ dollars,     
for a total inventory cost of \$ 82.50 .


***
\newpage

### 6. Use integration by parts to solve the integral $\int {ln( 9x ) \cdot x^6dx}$ .

Let $u = ln(9x)$ and $dv = x^6dx$ .   
Then $du = \frac{9dx}{9x} =  \frac{dx}{x}$ and $v = \frac{x^7}{7}$ .    

The formula for integration by parts:

$$\begin{aligned}
\int u \cdot dv &= u \cdot v - \int v \cdot du \\
\int {ln( 9x ) \cdot x^6dx} &= ln(9x) \cdot \frac{x^7}{7} - \int \frac{x^7}{7} \frac{dx}{x} \\
&=  \frac{x^7 \cdot ln(9x)}{7} - \int \frac{x^6dx}{7} \\
&=  \frac{x^7 \cdot ln(9x)}{7} - \frac{x^7dx}{7 \cdot 7} + C  \\
&= \frac{x^7}{7}\left[ln(9x)+\frac{1}{7}\right] + C 
\end{aligned}$$

***
\newpage

### 7. Determine whether $f ( x ) = \frac{1}{6x}$ is a probability density function on the interval $[1, e^6]$ . 
If not, determine the value of the definite integral  $\int\limits_1^{e^6}{\frac{1}{6x}dx}$   .     

For the function to be a PDF on the interval, 

* the value must always be non-negative, and 
* the definite integral needs to equal 1.

For the first requirement:    
$f ( x ) = \frac{1}{6x}>0$ for $x>0$, so this holds for $x \in [1, e^6]$ .    

For the second requirement:
$$\begin{aligned}
\int\limits_1^{e^6}{\frac{1}{6x}dx}
&= \left. \frac{ln(x)}{6} \right]_1^{e^6} \\
&= \frac{ln(e^6)-ln(1)}{6} \\
&= \frac{6-0}{6} \\
&= 1
\end{aligned}
$$

Therefore, the function is a PDF on the interval.



